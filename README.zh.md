# RustProxy 负载均衡器

基于 Rust 编写的高性能 SOCKS5/Shadowsocks 负载均衡器，带实时 Web 控制面板监控。

![控制面板截图](docs/screenshot.png)

## 项目动机

本项目的灵感来源于 HAProxy + SOCKS 负载均衡方案的局限性，这些方案在生产环境中被证明不够稳定。现有解决方案缺乏强大的性能缓存和后端禁用机制。RustProxy 是为了解决这些痛点而即兴创作的，专注于稳定性、性能和运维可见性。

## 功能特性

- **多协议支持**
  - Shadowsocks (SS) 支持 AES-256-GCM 加密
  - SOCKS5 代理协议
  - VMess AEAD 协议（兼容 v2ray 5.x）

- **负载均衡算法**
  - 随机分发
  - 轮询
  - 最少连接数

- **实时 Web 控制面板**
  - 实时流量监控及历史图表
  - 每个后端的统计信息（连接数、流量、延迟）
  - 活跃客户端追踪
  - 健康检查状态可视化
  - 动态启用/禁用后端

- **强大的健康检查**
  - HTTP/HTTPS ping 监控
  - 自动后端故障检测
  - 管理员控制的禁用状态（健康检查不会重新启用）
  - 可配置的健康检查间隔

- **性能与可靠性**
  - 基于 Tokio 的高吞吐量异步 I/O
  - 连接池和复用
  - 低开销的高效流量路由
  - 故障后端自动恢复

## 快速开始

### 构建

```bash
cargo build --release
```

### 运行

```bash
./target/release/rustproxy
```

Web 控制面板将在 `http://localhost:8080`（或您配置的端口）上可用。

### 配置

配置通常通过配置文件完成。详细配置选项请参阅项目文档，包括：
- 监听地址和端口
- 后端服务器地址
- 负载均衡算法
- Shadowsocks 加密设置
- 健康检查参数

## 控制面板功能

Web 控制面板提供全面的监控：

- **流量历史**：显示 TX/RX 速率的实时图表
- **后端状态**：查看所有后端的健康状态、活跃连接、流量统计和延迟
- **连接指标**：跟踪活跃连接数与限制
- **吞吐量监控**：实时和 24 小时流量统计
- **手动控制**：启用/禁用单个后端以进行维护

## 使用场景

- 多个代理服务器的负载均衡以实现高可用性
- 多个 Shadowsocks 后端之间的流量分发
- 具有健康感知故障转移的地理路由
- 使用实时指标进行性能测试和容量规划

## 许可证

采用以下任一许可证授权：

- Apache 许可证 2.0 版本 ([LICENSE-APACHE](LICENSE-APACHE) 或 http://www.apache.org/licenses/LICENSE-2.0)
- MIT 许可证 ([LICENSE-MIT](LICENSE-MIT) 或 http://opensource.org/licenses/MIT)

由您选择。

### 贡献

除非您明确声明，否则您有意提交以包含在本作品中的任何贡献，如 Apache-2.0 许可证中所定义，均应如上所述进行双重许可，不附加任何额外条款或条件。
